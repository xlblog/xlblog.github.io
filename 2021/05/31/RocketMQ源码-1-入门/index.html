<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":15,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="1. æ¦‚è¿°">
<meta property="og:type" content="article">
<meta property="og:title" content="RocketMQæºç :1.å…¥é—¨">
<meta property="og:url" content="http://example.com/2021/05/31/RocketMQ%E6%BA%90%E7%A0%81-1-%E5%85%A5%E9%97%A8/index.html">
<meta property="og:site_name" content="ä¹¡é—´å°é¹¿">
<meta property="og:description" content="1. æ¦‚è¿°">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://static.iocoder.cn/images/RocketMQ/2019_11_12/01.png">
<meta property="og:image" content="https://static.iocoder.cn/images/RocketMQ/2019_11_12/02.png">
<meta property="og:image" content="https://static.iocoder.cn/images/RocketMQ/2019_11_12/02.png">
<meta property="og:image" content="http://www.iocoder.cn/images/RocketMQ/2019-11-05/01.jpg">
<meta property="article:published_time" content="2021-05-31T03:36:10.000Z">
<meta property="article:modified_time" content="2021-09-17T08:28:42.930Z">
<meta property="article:author" content="æå¿ å‹">
<meta property="article:tag" content="bigdata">
<meta property="article:tag" content="rocketmq">
<meta property="article:tag" content="æ¶ˆæ¯ä¸­é—´ä»¶">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://static.iocoder.cn/images/RocketMQ/2019_11_12/01.png">

<link rel="canonical" href="http://example.com/2021/05/31/RocketMQ%E6%BA%90%E7%A0%81-1-%E5%85%A5%E9%97%A8/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>RocketMQæºç :1.å…¥é—¨ | ä¹¡é—´å°é¹¿</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">ä¹¡é—´å°é¹¿</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">æ¯ä¸€ä¸ªä¸æ›¾èµ·èˆçš„æ—¥å­éƒ½æ˜¯å¯¹ç”Ÿå‘½çš„è¾œè´Ÿ</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/05/31/RocketMQ%E6%BA%90%E7%A0%81-1-%E5%85%A5%E9%97%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="æå¿ å‹">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ä¹¡é—´å°é¹¿">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          RocketMQæºç :1.å…¥é—¨
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-05-31 11:36:10" itemprop="dateCreated datePublished" datetime="2021-05-31T11:36:10+08:00">2021-05-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-09-17 16:28:42" itemprop="dateModified" datetime="2021-09-17T16:28:42+08:00">2021-09-17</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/RocketMQ/" itemprop="url" rel="index"><span itemprop="name">RocketMQ</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="1-æ¦‚è¿°"><a href="#1-æ¦‚è¿°" class="headerlink" title="1. æ¦‚è¿°"></a>1. æ¦‚è¿°</h1><a id="more"></a>

<p>åœ¨å¼€å§‹æ­å»º RocketMQ æœåŠ¡ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥å¯¹å®ƒåšä¸‹ç®€å•çš„äº†è§£ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://rocketmq.apache.org/">RocketMQ</a> æ˜¯é˜¿é‡Œå·´å·´åœ¨ 2012 å¹´å¼€æºçš„åˆ†å¸ƒå¼æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œç›®å‰å·²ç»æèµ ç»™ Apache è½¯ä»¶åŸºé‡‘ä¼šï¼Œå¹¶äº 2017 å¹´ 9 æœˆ 25 æ—¥æˆä¸º Apache çš„é¡¶çº§é¡¹ç›®ã€‚ä½œä¸ºç»å†è¿‡å¤šæ¬¡é˜¿é‡Œå·´å·´åŒåä¸€è¿™ç§â€œè¶…çº§å·¥ç¨‹â€çš„æ´—ç¤¼å¹¶æœ‰ç¨³å®šå‡ºè‰²è¡¨ç°çš„å›½äº§ä¸­é—´ä»¶ï¼Œä»¥å…¶é«˜æ€§èƒ½ã€ä½å»¶æ—¶å’Œé«˜å¯é ç­‰ç‰¹æ€§è¿‘å¹´æ¥å·²ç»ä¹Ÿè¢«è¶Šæ¥è¶Šå¤šçš„å›½å†…ä¼ä¸šä½¿ç”¨ã€‚</p>
<p>å¦‚ä¸‹æ˜¯ RocketMQ äº§ç”Ÿçš„åŸå› ï¼š</p>
<blockquote>
<p>æ·˜å®å†…éƒ¨çš„äº¤æ˜“ç³»ç»Ÿä½¿ç”¨äº†æ·˜å®è‡ªä¸»ç ”å‘çš„ Notify æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œä½¿ç”¨ MySQL ä½œä¸ºæ¶ˆæ¯å­˜å‚¨åª’ä»‹ï¼Œå¯å®Œå…¨æ°´å¹³æ‰©å®¹ã€‚</p>
<p>ä¸ºäº†è¿›ä¸€æ­¥é™ä½æˆæœ¬ï¼Œæˆ‘ä»¬è®¤ä¸ºå­˜å‚¨éƒ¨åˆ†å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–ã€‚2011 å¹´åˆï¼ŒLinkin å¼€æºäº† Kafka è¿™ä¸ªä¼˜ç§€çš„æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œæ·˜å®ä¸­é—´ä»¶å›¢é˜Ÿåœ¨å¯¹ Kafka åšè¿‡å……åˆ† Review ä¹‹åï¼Œ Kafka æ— é™æ¶ˆæ¯å †ç§¯ï¼Œé«˜æ•ˆçš„æŒä¹…åŒ–é€Ÿåº¦å¸å¼•äº†æˆ‘ä»¬ã€‚</p>
<p>ä½†æ˜¯ï¼ŒåŒæ—¶å‘ç°è¿™ä¸ªæ¶ˆæ¯ç³»ç»Ÿä¸»è¦å®šä½äºæ—¥å¿—ä¼ è¾“ï¼Œå¯¹äºä½¿ç”¨åœ¨æ·˜å®äº¤æ˜“ã€è®¢å•ã€å……å€¼ç­‰åœºæ™¯ä¸‹è¿˜æœ‰è¯¸å¤šç‰¹æ€§ä¸æ»¡è¶³ï¼Œä¸ºæ­¤æˆ‘ä»¬é‡æ–°ç”¨ Java è¯­è¨€ç¼–å†™äº† RocketMQ ï¼Œå®šä½äºéæ—¥å¿—çš„å¯é æ¶ˆæ¯ä¼ è¾“ï¼ˆæ—¥å¿—åœºæ™¯ä¹Ÿ OKï¼‰ã€‚</p>
<p>ç›®å‰ RocketMQ åœ¨é˜¿é‡Œé›†å›¢è¢«å¹¿æ³›åº”ç”¨åœ¨è®¢å•ï¼Œäº¤æ˜“ï¼Œå……å€¼ï¼Œæµè®¡ç®—ï¼Œæ¶ˆæ¯æ¨é€ï¼Œæ—¥å¿—æµå¼å¤„ç†ï¼Œ binglog åˆ†å‘ç­‰åœºæ™¯ã€‚</p>
</blockquote>
<h2 id="1-1-åŸºæœ¬æ¦‚å¿µ"><a href="#1-1-åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="1.1 åŸºæœ¬æ¦‚å¿µ"></a>1.1 åŸºæœ¬æ¦‚å¿µ</h2><p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œå…ˆè®¤çœŸé˜…è¯»å¦‚ä¸‹ä¸¤ä¸ªæ–‡æ¡£ï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/apache/rocketmq/blob/master/docs/cn/concept.md">æ¦‚å¿µ(Concept)</a>ï¼šä»‹ç» RocketMQ çš„åŸºæœ¬æ¦‚å¿µæ¨¡å‹ã€‚</li>
<li><a target="_blank" rel="noopener" href="https://github.com/apache/rocketmq/blob/master/docs/cn/features.md">ç‰¹æ€§(Features)</a>ï¼šä»‹ç» RocketMQ å®ç°çš„åŠŸèƒ½ç‰¹æ€§ã€‚</li>
</ul>
<h2 id="1-2-æ•´ä½“æ¶æ„"><a href="#1-2-æ•´ä½“æ¶æ„" class="headerlink" title="1.2 æ•´ä½“æ¶æ„"></a>1.2 æ•´ä½“æ¶æ„</h2><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<img src="https://static.iocoder.cn/images/RocketMQ/2019_11_12/01.png" alt="è§’è‰²ç»„æˆ"></p>
<ul>
<li>ç”Ÿäº§è€…ï¼ˆProducerï¼‰ï¼šè´Ÿè´£äº§ç”Ÿæ¶ˆæ¯ï¼Œç”Ÿäº§è€…å‘æ¶ˆæ¯æœåŠ¡å™¨å‘é€ç”±ä¸šåŠ¡åº”ç”¨ç¨‹åºç³»ç»Ÿç”Ÿæˆçš„æ¶ˆæ¯ã€‚</li>
<li>æ¶ˆè´¹è€…ï¼ˆConsumerï¼‰ï¼šè´Ÿè´£æ¶ˆè´¹æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…ä»æ¶ˆæ¯æœåŠ¡å™¨æ‹‰å–ä¿¡æ¯å¹¶å°†å…¶è¾“å…¥ç”¨æˆ·åº”ç”¨ç¨‹åºã€‚</li>
<li>æ¶ˆæ¯æœåŠ¡å™¨ï¼ˆBrokerï¼‰ï¼šæ˜¯æ¶ˆæ¯å­˜å‚¨ä¸­å¿ƒï¼Œä¸»è¦ä½œç”¨æ˜¯æ¥æ”¶æ¥è‡ª Producer çš„æ¶ˆæ¯å¹¶å­˜å‚¨ï¼Œ Consumer ä»è¿™é‡Œå–å¾—æ¶ˆæ¯ã€‚</li>
<li>åç§°æœåŠ¡å™¨ï¼ˆNameServerï¼‰ï¼šç”¨æ¥ä¿å­˜ Broker ç›¸å…³ Topic ç­‰å…ƒä¿¡æ¯å¹¶ç»™ Producer ï¼Œæä¾› Consumer æŸ¥æ‰¾ Broker ä¿¡æ¯ã€‚</li>
</ul>
<h2 id="1-3-æ•´ä½“æµç¨‹"><a href="#1-3-æ•´ä½“æµç¨‹" class="headerlink" title="1.3 æ•´ä½“æµç¨‹"></a>1.3 æ•´ä½“æµç¨‹</h2><p><img src="https://static.iocoder.cn/images/RocketMQ/2019_11_12/02.png" alt="æ•´ä½“æµç¨‹"></p>
<ul>
<li><p>1ã€å¯åŠ¨ <strong>Namesrv</strong>ï¼ŒNamesrvèµ· æ¥åç›‘å¬ç«¯å£ï¼Œç­‰å¾… Brokerã€Producerã€Consumer è¿ä¸Šæ¥ï¼Œç›¸å½“äºä¸€ä¸ªè·¯ç”±æ§åˆ¶ä¸­å¿ƒã€‚</p>
</li>
<li><p>2ã€<strong>Broker</strong> å¯åŠ¨ï¼Œè·Ÿæ‰€æœ‰çš„ Namesrv ä¿æŒé•¿è¿æ¥ï¼Œå®šæ—¶å‘é€å¿ƒè·³åŒ…ã€‚</p>
<blockquote>
<p>å¿ƒè·³åŒ…ä¸­ï¼ŒåŒ…å«å½“å‰ Broker ä¿¡æ¯(IP+ç«¯å£ç­‰)ä»¥åŠå­˜å‚¨æ‰€æœ‰ Topic ä¿¡æ¯ã€‚ æ³¨å†ŒæˆåŠŸåï¼ŒNamesrv é›†ç¾¤ä¸­å°±æœ‰ Topic è·Ÿ Broker çš„æ˜ å°„å…³ç³»ã€‚</p>
</blockquote>
</li>
<li><p>3ã€æ”¶å‘æ¶ˆæ¯å‰ï¼Œå…ˆåˆ›å»º Topic ã€‚</p>
<blockquote>
<p>åˆ›å»º Topic æ—¶ï¼Œéœ€è¦æŒ‡å®šè¯¥ Topic è¦å­˜å‚¨åœ¨å“ªäº› Brokerä¸Šã€‚ä¹Ÿå¯ä»¥åœ¨å‘é€æ¶ˆæ¯æ—¶è‡ªåŠ¨åˆ›å»ºTopicã€‚</p>
</blockquote>
</li>
<li><p>4ã€<strong>Producer</strong> å‘é€æ¶ˆæ¯ã€‚</p>
<blockquote>
<p>å¯åŠ¨æ—¶ï¼Œå…ˆè·Ÿ Namesrv é›†ç¾¤ä¸­çš„å…¶ä¸­ä¸€å°å»ºç«‹é•¿è¿æ¥ï¼Œå¹¶ä»Namesrv ä¸­è·å–å½“å‰å‘é€çš„ Topic å­˜åœ¨å“ªäº› Broker ä¸Šï¼Œç„¶åè·Ÿå¯¹åº”çš„ Broker å»ºç«‹é•¿è¿æ¥ï¼Œç›´æ¥å‘ Broker å‘æ¶ˆæ¯ã€‚</p>
</blockquote>
</li>
<li><p>5ã€<strong>Consumer</strong> æ¶ˆè´¹æ¶ˆæ¯ã€‚</p>
<blockquote>
<p>Consumer è·Ÿ Producer ç±»ä¼¼ã€‚è·Ÿå…¶ä¸­ä¸€å° Namesrv å»ºç«‹é•¿è¿æ¥ï¼Œè·å–å½“å‰è®¢é˜… Topic å­˜åœ¨å“ªäº› Broker ä¸Šï¼Œç„¶åç›´æ¥è·Ÿ Broker å»ºç«‹è¿æ¥é€šé“ï¼Œå¼€å§‹æ¶ˆè´¹æ¶ˆæ¯ã€‚</p>
</blockquote>
</li>
</ul>
<h2 id="1-4-æ›´å¤šæ–‡æ¡£"><a href="#1-4-æ›´å¤šæ–‡æ¡£" class="headerlink" title="1.4 æ›´å¤šæ–‡æ¡£"></a>1.4 æ›´å¤šæ–‡æ¡£</h2><p>ç›®å‰ RocketMQ 4 çš„ä¸­æ–‡æ–‡æ¡£å¾ˆå°‘ï¼Œæ‰€ä»¥è‹±æ–‡ä¸å¤ªå¥½çš„æœ‹å‹ï¼Œåç»­æ¨èçœ‹çœ‹å¦‚ä¸‹èµ„æ–™ï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://gd-rus-public.cn-hangzhou.oss-pub.aliyun-inc.com/attachment/201604/08/20160408164726/RocketMQ_userguide.pdf">ã€ŠRocketMQ ç”¨æˆ·æŒ‡å—ã€‹</a> åŸºäº RocketMQ 3 çš„ç‰ˆæœ¬ã€‚</li>
<li><a target="_blank" rel="noopener" href="http://gd-rus-public.cn-hangzhou.oss-pub.aliyun-inc.com/attachment/201604/08/20160408165024/RocketMQ_design.pdf">ã€ŠRocketMQ åŸç†ç®€ä»‹ã€‹</a> åŸºäº RocketMQ 3 çš„ç‰ˆæœ¬ã€‚</li>
<li><a target="_blank" rel="noopener" href="http://gd-rus-public.cn-hangzhou.oss-pub.aliyun-inc.com/attachment/201604/08/20160408164929/RocketMQ_experience.pdf">ã€ŠRocketMQ æœ€ä½³å®è·µã€‹</a> åŸºäº RocketMQ 3 çš„ç‰ˆæœ¬ã€‚</li>
<li><a target="_blank" rel="noopener" href="https://github.com/apache/rocketmq/tree/master/docs/cn">ã€ŠRocketMQ å¼€å‘è€…æŒ‡å—ã€‹</a> åŸºäº RocketMQ 4 çš„ç‰ˆæœ¬ã€‚</li>
<li><a target="_blank" rel="noopener" href="https://help.aliyun.com/product/29530.html?spm=a2c4g.11186623.6.540.68cc5b3aZYDU2Y">ã€Šé˜¿é‡Œäº‘ â€”â€” æ¶ˆæ¯é˜Ÿåˆ— MQã€‹</a> é˜¿é‡Œäº‘çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå°±æ˜¯ RocketMQ çš„äº‘æœåŠ¡ã€‚</li>
</ul>
<h1 id="2-å•æœºéƒ¨ç½²"><a href="#2-å•æœºéƒ¨ç½²" class="headerlink" title="2. å•æœºéƒ¨ç½²"></a>2. å•æœºéƒ¨ç½²</h1><blockquote>
<p>å¯ä»¥å‚è€ƒ <a target="_blank" rel="noopener" href="https://rocketmq.apache.org/docs/quick-start/">ã€ŠApache RocketMQ â€”â€” Quick Startã€‹</a> æ–‡ç« ã€‚</p>
</blockquote>
<p>æœ¬å°èŠ‚ï¼Œæˆ‘ä»¬ä¼šéƒ¨ç½²ä¸€å¥— RocketMQ æœ€å°åŒ–çš„å•æœºç¯å¢ƒï¼ŒåŒ…æ‹¬ä¸€ä¸ª RocketMQ Namesrv å’Œ Broker æœåŠ¡ã€‚éƒ¨ç½²å®Œæˆä¹‹åï¼Œæˆ‘ä»¬ä¼šæµ‹è¯•æ¶ˆæ¯çš„å‘é€ä¸æ¶ˆè´¹ã€‚ä¸‹é¢ï¼Œè®©æˆ‘ä»¬é€æ­¥å¼€å§‹ã€‚</p>
<h2 id="2-1-å‰ç½®æ¡ä»¶"><a href="#2-1-å‰ç½®æ¡ä»¶" class="headerlink" title="2.1 å‰ç½®æ¡ä»¶"></a>2.1 å‰ç½®æ¡ä»¶</h2><p>éœ€è¦å®‰è£…å¦‚ä¸‹è½¯ä»¶ï¼š</p>
<ul>
<li>JDK 8+</li>
<li>Maven 3.2.X+</li>
</ul>
<p>å› ä¸ºæˆ‘ä»¬å‡†å¤‡ç›´æ¥ç¼–è¯‘ RocketMQ æºç ï¼Œæ„å»ºå‡º RocketMQ è½¯ä»¶åŒ…ã€‚</p>
<h2 id="2-2-ä¸‹è½½æºç "><a href="#2-2-ä¸‹è½½æºç " class="headerlink" title="2.2 ä¸‹è½½æºç "></a>2.2 ä¸‹è½½æºç </h2><p>æ‰“å¼€ <a target="_blank" rel="noopener" href="http://rocketmq.apache.org/release_notes/">RocketMQ release_notes</a> é¡µé¢ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° RocketMQ æ‰€æœ‰çš„å‘å¸ƒç‰ˆæœ¬ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬é€‰æ‹©æœ€æ–°çš„ <a target="_blank" rel="noopener" href="http://rocketmq.apache.org/release_notes/release-notes-4.6.0/">RocketMQ 4.6.0</a> ç‰ˆæœ¬ã€‚ç‚¹å‡»è¿›å…¥è¯¥ç‰ˆæœ¬çš„å‘å¸ƒé¡µé¢åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸¤ç§å‘å¸ƒç‰ˆæœ¬ï¼š</p>
<ul>
<li>Source: <a target="_blank" rel="noopener" href="https://www.apache.org/dyn/closer.cgi?path=rocketmq/4.6.0/rocketmq-all-4.6.0-source-release.zip">rocketmq-all-4.6.0-source-release.zip</a></li>
<li>Binary: <a target="_blank" rel="noopener" href="https://www.apache.org/dyn/closer.cgi?path=rocketmq/4.6.0/rocketmq-all-4.6.0-bin-release.zip">rocketmq-all-4.6.0-bin-release.zip</a></li>
</ul>
<p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ Binary ç‰ˆæœ¬ï¼Œå®ƒæ˜¯ RocketMQ å·²ç»ç¼–è¯‘å¥½ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨çš„ RocketMQ è½¯ä»¶åŒ…ã€‚</p>
<p>è¿™é‡Œï¼Œæˆ‘æƒ³å¸¦ç€å¤§å®¶ç¼–è¯‘ä¸€æ¬¡ RocketMQ æºç ï¼Œå› ä¸ºæˆ‘ä»¬å†…éƒ¨ä½¿ç”¨çš„RocketMQæ˜¯æˆ‘ä»¬æ ¹æ®è‡ªå·±çš„ä¸šåŠ¡éœ€æ±‚ä¿®æ”¹è¿‡çš„ï¼Œæ‰€ä»¥æˆ‘ä½¿ç”¨ Source ç‰ˆæœ¬ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬å¼€å§‹ä¸‹è½½ RocketMQ 4.6.0 Source æºç ã€‚å‘½ä»¤è¡Œæ“ä½œå¦‚ä¸‹ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸‹è½½</span></span><br><span class="line">$ wget wget http://mirror.bit.edu.cn/apache/rocketmq/4.6.0/rocketmq-all-4.6.0-source-release.zip</span><br><span class="line"></span><br><span class="line"><span class="comment"># è§£å‹</span></span><br><span class="line">$ unzip rocketmq-all-4.6.0-source-release.zip</span><br></pre></td></tr></table></figure>


<h2 id="2-2-ç¼–è¯‘æºç "><a href="#2-2-ç¼–è¯‘æºç " class="headerlink" title="2.2 ç¼–è¯‘æºç "></a>2.2 ç¼–è¯‘æºç </h2><p>ä½¿ç”¨ Maven ç¼–è¯‘ RocketMQ æºç ã€‚å‘½ä»¤è¡Œæ“ä½œå¦‚ä¸‹ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿›å…¥ RocketMQ æºç ç›®å½•</span></span><br><span class="line">$ <span class="built_in">cd</span> rocketmq-all-4.6.0-source-release</span><br><span class="line"></span><br><span class="line"><span class="comment"># Maven ç¼–è¯‘ RocketMQ ï¼Œå¹¶è·³è¿‡æµ‹è¯•ã€‚è€å¿ƒç­‰å¾…...</span></span><br><span class="line">$ mvn -Prelease-all -DskipTests clean install -U</span><br></pre></td></tr></table></figure>
<p>ç¼–è¯‘å®Œæˆï¼Œåœ¨æˆ‘ä»¬è¿›å…¥ distribution ç›®å½•ä¸‹ï¼Œå°±å¯ä»¥çœ‹åˆ° RocketMQ çš„å‘å¸ƒåŒ…äº†ã€‚å‘½ä»¤è¡Œæ“ä½œå¦‚ä¸‹ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿›å…¥ distribution ç›®å½•ä¸‹</span></span><br><span class="line">$ <span class="built_in">cd</span> distribution/target/rocketmq-4.6.0/rocketmq-4.6.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å°ç›®å½•</span></span><br><span class="line">$ ls</span><br><span class="line">40 -rwxr-xr-x   1 yunai  staff  17336 Nov 19 20:59 LICENSE</span><br><span class="line"> 8 -rwxr-xr-x   1 yunai  staff   1338 Nov 19 20:59 NOTICE</span><br><span class="line">16 -rwxr-xr-x   1 yunai  staff   4225 Nov 19 20:59 README.md</span><br><span class="line"> 0 drwxr-xr-x   6 yunai  staff    192 Dec  3 12:48 benchmark <span class="comment"># æ€§èƒ½åŸºå‡†æµ‹è¯•</span></span><br><span class="line"> 0 drwxr-xr-x  30 yunai  staff    960 Nov 19 20:59 bin <span class="comment"># æ‰§è¡Œè„šæœ¬</span></span><br><span class="line"> 0 drwxr-xr-x  12 yunai  staff    384 Nov 19 20:59 conf <span class="comment"># é…ç½®æ–‡ä»¶</span></span><br><span class="line"> 0 drwxr-xr-x  36 yunai  staff   1152 Dec  3 12:48 lib <span class="comment"># RocketMQ jar åŒ…</span></span><br></pre></td></tr></table></figure>


<h2 id="2-3-å¯åŠ¨-Namesrv"><a href="#2-3-å¯åŠ¨-Namesrv" class="headerlink" title="2.3 å¯åŠ¨ Namesrv"></a>2.3 å¯åŠ¨ Namesrv</h2><p>å¯åŠ¨ä¸€ä¸ª RocketMQ Namesrv æœåŠ¡ã€‚å‘½ä»¤è¡Œæ“ä½œå¦‚ä¸‹ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup sh bin/mqnamesrv &amp;</span><br></pre></td></tr></table></figure>
<p>å¯åŠ¨å®Œæˆåï¼ŒæŸ¥çœ‹æ—¥å¿—ã€‚</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹ Namesrv æ—¥å¿—ã€‚</span></span><br><span class="line">$ tail -f ~/logs/rocketmqlogs/namesrv.log</span><br><span class="line"></span><br><span class="line">2019-12-03 12:58:04 INFO main - The Name Server boot success. serializeType=JSON</span><br></pre></td></tr></table></figure>
<ul>
<li>é»˜è®¤æƒ…å†µä¸‹ï¼ŒNamesrv æ—¥å¿—æ–‡ä»¶æ‰€åœ¨åœ°å€ä¸º <code>~/logs/rocketmqlogs/namesrv.log</code> ã€‚å¦‚æœæƒ³è¦è‡ªå®šä¹‰ï¼Œå¯ä»¥é€šè¿‡ <code>conf/logback_namesrv.xml</code> é…ç½®æ–‡ä»¶æ¥è¿›è¡Œä¿®æ”¹ã€‚</li>
</ul>
<h2 id="2-4-å¯åŠ¨-Broker"><a href="#2-4-å¯åŠ¨-Broker" class="headerlink" title="2.4 å¯åŠ¨ Broker"></a>2.4 å¯åŠ¨ Broker</h2><p>åœ¨ <code>conf</code> ç›®å½•ä¸‹ï¼ŒRocketMQ æä¾›äº†å¤šç§ Broker çš„é…ç½®æ–‡ä»¶ï¼š</p>
<ul>
<li><code>broker.conf</code> ï¼šå•ä¸»ï¼Œå¼‚æ­¥åˆ·ç›˜ã€‚</li>
<li><code>2m/</code> ï¼šåŒä¸»ï¼Œå¼‚æ­¥åˆ·ç›˜ã€‚</li>
<li><code>2m-2s-async/</code> ï¼šä¸¤ä¸»ä¸¤ä»ï¼Œå¼‚æ­¥å¤åˆ¶ï¼Œå¼‚æ­¥åˆ·ç›˜ã€‚</li>
<li><code>2m-2s-sync/</code> ï¼šä¸¤ä¸»ä¸¤ä»ï¼ŒåŒæ­¥å¤åˆ¶ï¼Œå¼‚æ­¥åˆ·ç›˜ã€‚</li>
<li><code>dledger/</code> ï¼š<a target="_blank" rel="noopener" href="https://github.com/apache/rocketmq/blob/master/docs/cn/dledger/deploy_guide.md">Dledger é›†ç¾¤</a>ï¼Œè‡³å°‘ä¸‰èŠ‚ç‚¹ã€‚</li>
</ul>
<p>è¿™é‡Œï¼Œæˆ‘ä»¬åªå¯åŠ¨ä¸€ä¸ª RocketMQ Broker æœåŠ¡ï¼Œæ‰€ä»¥ä½¿ç”¨ <code>broker.conf</code> é…ç½®æ–‡ä»¶ã€‚å‘½ä»¤è¡Œæ“ä½œå¦‚ä¸‹ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup sh bin/mqbroker -c conf/broker.conf  -n 127.0.0.1:9876 &amp;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>é€šè¿‡ <code>-c</code> å‚æ•°ï¼Œé…ç½®è¯»å–çš„ä¸» Broker é…ç½®ã€‚</p>
</li>
<li><p>é€šè¿‡ <code>-n</code> å‚æ•°ï¼Œè®¾ç½® RocketMQ Namesrv åœ°å€ã€‚</p>
</li>
<li><p>å¦‚æœå¤§å®¶çš„æœåŠ¡å™¨çš„å­˜ç›¸å¯¹å°ï¼Œå¯ä»¥ä¿®æ”¹ä¸‹ <code>bin/runbroker.sh</code> è„šæœ¬ï¼Œå°† Broker JVM å†…å­˜è°ƒå°ã€‚å¦‚ä¸‹ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">JAVA_OPT=<span class="string">&quot;<span class="variable">$&#123;JAVA_OPT&#125;</span> -server -Xms4g -Xmx4g -Xmn2g&quot;</span></span><br></pre></td></tr></table></figure>
<p>å¯åŠ¨å®Œæˆåï¼ŒæŸ¥çœ‹æ—¥å¿—ã€‚</p>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tail -f ~/logs/rocketmqlogs/broker.log</span><br><span class="line"></span><br><span class="line">2019-12-03 14:27:07 INFO main - The broker[broker-a, 192.168.3.44:10911] boot success. serializeType=JSON and name server is 127.0.0.1:9876</span><br></pre></td></tr></table></figure>
<ul>
<li>é»˜è®¤æƒ…å†µä¸‹ï¼ŒBroker æ—¥å¿—æ–‡ä»¶æ‰€åœ¨åœ°å€ä¸º <code>~/logs/rocketmqlogs/broker.log</code> ã€‚å¦‚æœæƒ³è¦è‡ªå®šä¹‰ï¼Œå¯ä»¥é€šè¿‡ <code>conf/logback_broker.xml</code> é…ç½®æ–‡ä»¶æ¥è¿›è¡Œä¿®æ”¹ã€‚</li>
</ul>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº† RocketMQ å•æœºéƒ¨ç½²ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬å¼€å§‹è¿›è¡Œä¸‹æ¶ˆæ¯çš„å‘é€å’Œæ¶ˆè´¹çš„æµ‹è¯•ã€‚</p>
<h2 id="2-5-æµ‹è¯•å‘é€æ¶ˆæ¯"><a href="#2-5-æµ‹è¯•å‘é€æ¶ˆæ¯" class="headerlink" title="2.5 æµ‹è¯•å‘é€æ¶ˆæ¯"></a>2.5 æµ‹è¯•å‘é€æ¶ˆæ¯</h2><p>é€šè¿‡ä½¿ç”¨ <code>bin/tools.sh</code> å·¥å…·ç±»ï¼Œå®ç°æµ‹è¯•å‘é€æ¶ˆæ¯ã€‚å‘½ä»¤è¡Œæ“ä½œå¦‚ä¸‹ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½® Namesrv æœåŠ¡å™¨çš„åœ°å€export NAMESRV_ADDR=127.0.0.1:9876# æ‰§è¡Œç”Ÿäº§è€… Producer å‘é€æµ‹è¯•æ¶ˆæ¯sh bin/tools.sh org.apache.rocketmq.example.quickstart.Producer</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœå‘é€æˆåŠŸï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°å¤§é‡æˆåŠŸçš„å‘é€æ—¥å¿—ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SendResult [sendStatus&#x3D;SEND_OK, msgId&#x3D;FE800000000000004F2B5386138462F500000D7163610D67E7F100F4, offsetMsgId&#x3D;C0A8032C00002A9F000000000000D7EE, messageQueue&#x3D;MessageQueue [topic&#x3D;TopicTest, brokerName&#x3D;broker-a, queueId&#x3D;0], queueOffset&#x3D;61]SendResult [sendStatus&#x3D;SEND_OK, msgId&#x3D;FE800000000000004F2B5386138462F500000D7163610D67E7F200F5, offsetMsgId&#x3D;C0A8032C00002A9F000000000000D8D1, messageQueue&#x3D;MessageQueue [topic&#x3D;TopicTest, brokerName&#x3D;broker-a, queueId&#x3D;1], queueOffset&#x3D;61]</span><br></pre></td></tr></table></figure>
<ul>
<li>é€šè¿‡å‘é€ç»“æœä¸º <code>sendStatus=SEND_OK</code> çŠ¶æ€ï¼Œè¯´æ˜æ¶ˆæ¯éƒ½å‘é€æˆåŠŸäº†ã€‚</li>
</ul>
<h2 id="2-6-æµ‹è¯•æ¶ˆè´¹æ¶ˆæ¯"><a href="#2-6-æµ‹è¯•æ¶ˆè´¹æ¶ˆæ¯" class="headerlink" title="2.6 æµ‹è¯•æ¶ˆè´¹æ¶ˆæ¯"></a>2.6 æµ‹è¯•æ¶ˆè´¹æ¶ˆæ¯</h2><p>é€šè¿‡ä½¿ç”¨ <code>bin/tools.sh</code> å·¥å…·ç±»ï¼Œå®ç°æµ‹è¯•æ¶ˆè´¹æ¶ˆæ¯ã€‚å‘½ä»¤è¡Œæ“ä½œå¦‚ä¸‹ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½® Namesrv æœåŠ¡å™¨çš„åœ°å€export NAMESRV_ADDR=127.0.0.1:9876# æ‰§è¡Œæ¶ˆè´¹è€… Consumer æ¶ˆè´¹æµ‹è¯•æ¶ˆæ¯sh bin/tools.sh org.apache.rocketmq.example.quickstart.Consumer</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœæ¶ˆè´¹æˆåŠŸï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°å¤§é‡æˆåŠŸçš„æ¶ˆè´¹æ—¥å¿—ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ConsumeMessageThread_4 Receive New Messages: [MessageExt [queueId&#x3D;2, storeSize&#x3D;227, queueOffset&#x3D;131, sysFlag&#x3D;0, bornTimestamp&#x3D;1575354513732, bornHost&#x3D;&#x2F;192.168.3.44:55510, storeTimestamp&#x3D;1575354513733, storeHost&#x3D;&#x2F;192.168.3.44:10911, msgId&#x3D;C0A8032C00002A9F000000000001D1FC, commitLogOffset&#x3D;119292, bodyCRC&#x3D;1549304357, reconsumeTimes&#x3D;0, preparedTransactionOffset&#x3D;0, toString()&#x3D;Message&#123;topic&#x3D;&#39;TopicTest&#39;, flag&#x3D;0, properties&#x3D;&#123;MIN_OFFSET&#x3D;0, MAX_OFFSET&#x3D;145, CONSUME_START_TIME&#x3D;1575354867104, UNIQ_KEY&#x3D;FE800000000000004F2B5386138462F500000D7163610D67E944020E, CLUSTER&#x3D;DefaultCluster, WAIT&#x3D;true, TAGS&#x3D;TagA&#125;, body&#x3D;[72, 101, 108, 108, 111, 32, 82, 111, 99, 107, 101, 116, 77, 81, 32, 53, 50, 54], transactionId&#x3D;&#39;null&#39;&#125;]]ConsumeMessageThread_3 Receive New Messages: [MessageExt [queueId&#x3D;2, storeSize&#x3D;227, queueOffset&#x3D;130, sysFlag&#x3D;0, bornTimestamp&#x3D;1575354513729, bornHost&#x3D;&#x2F;192.168.3.44:55510, storeTimestamp&#x3D;1575354513729, storeHost&#x3D;&#x2F;192.168.3.44:10911, msgId&#x3D;C0A8032C00002A9F000000000001CE70, commitLogOffset&#x3D;118384, bodyCRC&#x3D;1530218044, reconsumeTimes&#x3D;0, preparedTransactionOffset&#x3D;0, toString()&#x3D;Message&#123;topic&#x3D;&#39;TopicTest&#39;, flag&#x3D;0, properties&#x3D;&#123;MIN_OFFSET&#x3D;0, MAX_OFFSET&#x3D;145, CONSUME_START_TIME&#x3D;1575354867103, UNIQ_KEY&#x3D;FE800000000000004F2B5386138462F500000D7163610D67E941020A, CLUSTER&#x3D;DefaultCluster, WAIT&#x3D;true, TAGS&#x3D;TagA&#125;, body&#x3D;[72, 101, 108, 108, 111, 32, 82, 111, 99, 107, 101, 116, 77, 81, 32, 53, 50, 50], transactionId&#x3D;&#39;null&#39;&#125;]]</span><br></pre></td></tr></table></figure>
<ul>
<li>é€šè¿‡ <code>ConsumeMessageThread_4</code> å’Œ <code>ConsumeMessageThread_3</code> çº¿ç¨‹åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œç›®å‰æ˜¯è¿›è¡Œå¹¶å‘æ¶ˆè´¹æ¶ˆæ¯ã€‚</li>
</ul>
<h1 id="3-é›†ç¾¤éƒ¨ç½²"><a href="#3-é›†ç¾¤éƒ¨ç½²" class="headerlink" title="3. é›†ç¾¤éƒ¨ç½²"></a>3. é›†ç¾¤éƒ¨ç½²</h1><p>åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œå¿…é¡»æ­å»º RocketMQ é«˜å¯ç”¨é›†ç¾¤ã€‚ä¸€èˆ¬ RocketMQ çš„é›†ç¾¤éƒ¨ç½²æ–¹æ¡ˆæ¨èå¦‚ä¸‹ï¼š</p>
<ul>
<li>å¦‚æœå¯¹é«˜æ€§èƒ½æœ‰æ¯”è¾ƒå¼ºçš„è¯‰æ±‚ï¼Œä½¿ç”¨ä¸¤ä¸»ä¸¤ä»ï¼Œå¼‚æ­¥å¤åˆ¶ï¼Œå¼‚æ­¥åˆ·ç›˜ã€‚</li>
<li>å¦‚æœå¯¹å¯é æ€§æœ‰æ¯”è¾ƒå¼ºçš„è¯‰æ±‚ï¼Œå»ºè®®ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://github.com/apache/rocketmq/blob/master/docs/cn/dledger/deploy_guide.md">Dledger é›†ç¾¤</a>ï¼Œè‡³å°‘ä¸‰èŠ‚ç‚¹ã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯RocketMQ å®ç°é«˜å¯ç”¨çš„åŸç†ã€‚</p>
<p><img src="https://static.iocoder.cn/images/RocketMQ/2019_11_12/02.png" alt="RocketMQ é›†ç¾¤"></p>
<p>ğŸ¦… <strong>1. Producer</strong></p>
<ul>
<li>1ã€Producer è‡ªèº«åœ¨åº”ç”¨ä¸­ï¼Œæ‰€ä»¥æ— éœ€è€ƒè™‘é«˜å¯ç”¨ã€‚</li>
<li>2ã€Producer é…ç½®å¤šä¸ª Namesrv åˆ—è¡¨ï¼Œä»è€Œä¿è¯ Producer å’Œ Namesrv çš„è¿æ¥é«˜å¯ç”¨ã€‚å¹¶ä¸”ï¼Œä¼šä» Namesrv å®šæ—¶æ‹‰å–æœ€æ–°çš„ Topic ä¿¡æ¯ã€‚</li>
<li>3ã€Producer ä¼šå’Œæ‰€æœ‰ Consumer ç›´è¿ï¼Œåœ¨å‘é€æ¶ˆæ¯æ—¶ï¼Œä¼šé€‰æ‹©ä¸€ä¸ª Broker è¿›è¡Œå‘é€ã€‚å¦‚æœå‘é€å¤±è´¥ï¼Œåˆ™ä¼šä½¿ç”¨å¦å¤–ä¸€ä¸ª Broker ã€‚</li>
<li>4ã€Producer ä¼šå®šæ—¶å‘ Broker å¿ƒè·³ï¼Œè¯æ˜å…¶å­˜æ´»ã€‚è€Œ Broker ä¼šå®šæ—¶æ£€æµ‹ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰ Producer å¼‚å¸¸ä¸‹çº¿ã€‚</li>
</ul>
<p>ğŸ¦… <strong>2. Consumer</strong></p>
<ul>
<li>1ã€Consumer éœ€è¦éƒ¨ç½²å¤šä¸ªèŠ‚ç‚¹ï¼Œä»¥ä¿è¯ Consumer è‡ªèº«çš„é«˜å¯ç”¨ã€‚å½“ç›¸åŒæ¶ˆè´¹è€…åˆ†ç»„ä¸­æœ‰æ–°çš„ Consumer ä¸Šçº¿ï¼Œæˆ–è€…è€çš„ Consumer ä¸‹çº¿ï¼Œä¼šé‡æ–°åˆ†é… Topic çš„ Queue åˆ°ç›®å‰æ¶ˆè´¹åˆ†ç»„çš„ Consumer ä»¬ã€‚</li>
<li>2ã€Consumer é…ç½®å¤šä¸ª Namesrv åˆ—è¡¨ï¼Œä»è€Œä¿è¯ Consumer å’Œ Namesrv çš„è¿æ¥é«˜å¯ç”¨ã€‚å¹¶ä¸”ï¼Œä¼šä» Consumer å®šæ—¶æ‹‰å–æœ€æ–°çš„ Topic ä¿¡æ¯ã€‚</li>
<li>3ã€Consumer ä¼šå’Œæ‰€æœ‰ Broker ç›´è¿ï¼Œæ¶ˆè´¹ç›¸åº”åˆ†é…åˆ°çš„ Queue çš„æ¶ˆæ¯ã€‚å¦‚æœæ¶ˆè´¹å¤±è´¥ï¼Œåˆ™ä¼šå‘å›æ¶ˆæ¯åˆ° Broker ä¸­ã€‚</li>
<li>4ã€Consumer ä¼šå®šæ—¶å‘ Broker å¿ƒè·³ï¼Œè¯æ˜å…¶å­˜æ´»ã€‚è€Œ Broker ä¼šå®šæ—¶æ£€æµ‹ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰ Consumer å¼‚å¸¸ä¸‹çº¿ã€‚</li>
</ul>
<p>ğŸ¦… <strong>3. Namesrv</strong></p>
<ul>
<li>1ã€Namesrv éœ€è¦éƒ¨ç½²å¤šä¸ªèŠ‚ç‚¹ï¼Œä»¥ä¿è¯ Namesrv çš„é«˜å¯ç”¨ã€‚</li>
<li>2ã€Namesrv æœ¬èº«æ˜¯æ— çŠ¶æ€ï¼Œä¸äº§ç”Ÿæ•°æ®çš„å­˜å‚¨ï¼Œæ˜¯é€šè¿‡ Broker å¿ƒè·³å°† Topic ä¿¡æ¯åŒæ­¥åˆ° Namesrv ä¸­ã€‚</li>
<li>3ã€å¤šä¸ª Namesrv ä¹‹é—´ä¸ä¼šæœ‰æ•°æ®çš„åŒæ­¥ï¼Œæ˜¯é€šè¿‡ Broker å‘å¤šä¸ª Namesrv å¤šå†™ã€‚</li>
</ul>
<p>ğŸ¦… <strong>4. Broker</strong></p>
<ul>
<li>1ã€å¤šä¸ª Broker å¯ä»¥å½¢æˆä¸€ä¸ª Broker åˆ†ç»„ã€‚æ¯ä¸ª Broker åˆ†ç»„å­˜åœ¨ä¸€ä¸ª Master å’Œå¤šä¸ª Slave èŠ‚ç‚¹ã€‚<ul>
<li>Master èŠ‚ç‚¹ï¼Œå¯æä¾›è¯»å’Œå†™åŠŸèƒ½ã€‚Slave èŠ‚ç‚¹ï¼Œå¯æä¾›è¯»åŠŸèƒ½ã€‚</li>
<li>Master èŠ‚ç‚¹ä¼šä¸æ–­å‘é€æ–°çš„ CommitLog ç»™ SlaveèŠ‚ç‚¹ã€‚Slave èŠ‚ç‚¹ä¸æ–­ä¸ŠæŠ¥æœ¬åœ°çš„ CommitLog å·²ç»åŒæ­¥åˆ°çš„ä½ç½®ç»™ Master èŠ‚ç‚¹ã€‚</li>
<li>Slave èŠ‚ç‚¹ä¼šä» Master èŠ‚ç‚¹æ‹‰å–æ¶ˆè´¹è¿›åº¦ã€Topic é…ç½®ç­‰ç­‰ã€‚</li>
</ul>
</li>
<li>2ã€å¤šä¸ª Broker åˆ†ç»„ï¼Œå½¢æˆ Broker é›†ç¾¤ã€‚<ul>
<li>Broker é›†ç¾¤å’Œé›†ç¾¤ä¹‹é—´ï¼Œä¸å­˜åœ¨é€šä¿¡ä¸æ•°æ®åŒæ­¥ã€‚</li>
</ul>
</li>
<li>3ã€Broker å¯ä»¥é…ç½®åŒæ­¥åˆ·ç›˜æˆ–å¼‚æ­¥åˆ·ç›˜ï¼Œæ ¹æ®æ¶ˆæ¯çš„æŒä¹…åŒ–çš„å¯é æ€§æ¥é…ç½®ã€‚</li>
</ul>
<h1 id="4-Web-Console-æ§åˆ¶å°"><a href="#4-Web-Console-æ§åˆ¶å°" class="headerlink" title="4. Web Console æ§åˆ¶å°"></a>4. Web Console æ§åˆ¶å°</h1><p>åœ¨ RocketMQ æ‹“å±•é¡¹ç›®(<a target="_blank" rel="noopener" href="https://github.com/apache/rocketmq-externals">rocketmq-externals</a>) ä¸­ï¼ŒåŒ…å«äº† <a target="_blank" rel="noopener" href="https://github.com/apache/rocketmq-externals/tree/master/rocketmq-console">RocketMQ Console</a> é¡¹ç›®ï¼Œæ˜¯ RocketMQ çš„å›¾å½¢åŒ–ç®¡ç†æ§åˆ¶å°ï¼Œæä¾› Broker é›†ç¾¤ä¿¡æ¯æŸ¥çœ‹ï¼ŒTopic ç®¡ç†ï¼ŒProducerã€Consumer ä¿¡æ¯å±•ç¤ºï¼Œæ¶ˆæ¯æŸ¥è¯¢ç­‰ç­‰å¸¸ç”¨åŠŸèƒ½ã€‚</p>
<p>è™½ç„¶è¯´ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ RocketMQ æä¾›çš„ <a target="_blank" rel="noopener" href="http://rocketmq.apache.org/docs/cli-admin-tool/">CLI Admin Tool</a> å·¥å…·ï¼Œå®ç°ä¸Šè¿°çš„æŸ¥è¯¢ä¸ç®¡ç†çš„åŠŸèƒ½ï¼Œä½†æ˜¯å‘½ä»¤è¡Œçš„æ–¹å¼å¯¹æ“ä½œäººå‘˜çš„è¦æ±‚ç¨é«˜ä¸€äº›ã€‚å½“ç„¶ï¼Œåœ¨ RocketMQ Console æ— æ³•æ»¡è¶³æˆ‘ä»¬æ›´ç²¾ç»†åŒ–çš„ç®¡ç†çš„éœ€æ±‚çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä¼šä½¿ç”¨ CLI Admin Tool å·¥å…·ã€‚</p>
<p>ä¸‹é¢ï¼Œè®©æˆ‘ä»¬æ¥æ­å»ºä¸€ä¸ª RocketMQ Console æ§åˆ¶å°ã€‚</p>
<h2 id="4-1-å…‹éš†ä»£ç "><a href="#4-1-å…‹éš†ä»£ç " class="headerlink" title="4.1 å…‹éš†ä»£ç "></a>4.1 å…‹éš†ä»£ç </h2><p>å°† <a target="_blank" rel="noopener" href="https://github.com/apache/rocketmq-externals">rocketmq-externals</a> ä»“åº“çš„ä»£ç ï¼Œå…‹éš†åˆ°æœ¬åœ°ã€‚æ“ä½œæµç¨‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…‹éš†ä»£ç $ git clone https://github.com/apache/rocketmq-externals.git# è¿›å…¥ Console ç›®å½•$ cd rocketmq-console</span></span><br></pre></td></tr></table></figure>
<h2 id="4-2-é…ç½®æ–‡ä»¶"><a href="#4-2-é…ç½®æ–‡ä»¶" class="headerlink" title="4.2 é…ç½®æ–‡ä»¶"></a>4.2 é…ç½®æ–‡ä»¶</h2><p>å¦‚æœå¤§å®¶éœ€è¦è‡ªå®šä¹‰ RocketMQ Console çš„é…ç½®ï¼Œå¯ä»¥è¿›å…¥è¯¥é¡¹ç›®ä¸‹çš„ <code>src/main/resources/</code> ç›®å½•ä¸‹ï¼Œè¿›è¡Œç›¸åº”çš„é…ç½®æ–‡ä»¶ä¿®æ”¹ã€‚ä¾‹å¦‚è¯´ï¼Œè®¾ç½® RocketMQ Namesrv åœ°å€ï¼Œå¼€å¯ RocketMQ Console çš„ç™»å½•è®¿é—®ã€‚</p>
<p>è¿™é‡Œï¼Œæˆ‘ä»¬ä¿®æ”¹ <code>src/main/resources/application.properties</code> é…ç½®æ–‡ä»¶ï¼Œé€šè¿‡è®¾ç½® <code>rocketmq.config.namesrvAddr=127.0.0.1:9876</code> é…ç½®é¡¹ï¼Œè®¾ç½® RocketMQ Namesrv çš„åœ°å€ã€‚</p>
<h2 id="4-3-ç¼–è¯‘æºç "><a href="#4-3-ç¼–è¯‘æºç " class="headerlink" title="4.3 ç¼–è¯‘æºç "></a>4.3 ç¼–è¯‘æºç </h2><p>ä½¿ç”¨ Maven ç¼–è¯‘ RocketMQ Console æºç ã€‚å‘½ä»¤è¡Œæ“ä½œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># ç¼–è¯‘$ mvn clean package -Dmaven.test.skip&#x3D;true</span><br></pre></td></tr></table></figure>
<h2 id="4-4-å¯åŠ¨æ§åˆ¶å°"><a href="#4-4-å¯åŠ¨æ§åˆ¶å°" class="headerlink" title="4.4 å¯åŠ¨æ§åˆ¶å°"></a>4.4 å¯åŠ¨æ§åˆ¶å°</h2><p>ç›´æ¥ä»¥ <code>jar</code> çš„æ–¹å¼ï¼Œå¯åŠ¨æ§åˆ¶å°ã€‚æ³¨æ„ï¼Œæ§åˆ¶å°ä½¿ç”¨ 8080 ç«¯å£ã€‚å‘½ä»¤è¡Œæ“ä½œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup java -jar target&#x2F;rocketmq-console-ng-1.0.1.jar &amp;</span><br></pre></td></tr></table></figure>
<p>å¯åŠ¨å®Œæˆåï¼ŒæŸ¥çœ‹æ—¥å¿—ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ tail -f nohup.out[2019-12-03 16:05:19.349]  INFO Tomcat started on port(s): 8080 (http)[2019-12-03 16:05:19.354]  INFO Started App in 5.341 seconds (JVM running for 6.104)</span><br></pre></td></tr></table></figure>
<ul>
<li>å½“çœ‹åˆ°å¦‚ä¸Šæ—¥å¿—ï¼Œè¯´æ˜ Console æ§åˆ¶å°å¯åŠ¨å®Œæˆã€‚</li>
</ul>
<h2 id="4-5-ç®€å•ä½¿ç”¨"><a href="#4-5-ç®€å•ä½¿ç”¨" class="headerlink" title="4.5 ç®€å•ä½¿ç”¨"></a>4.5 ç®€å•ä½¿ç”¨</h2><p>ä½¿ç”¨æµè§ˆå™¨ï¼Œè®¿é—® <a target="_blank" rel="noopener" href="http://127.0.0.1:8080/">http://127.0.0.1:8080/</a> åœ°å€ï¼Œæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ° RocketMQ Console çš„ç•Œé¢ã€‚å¦‚ä¸‹å›¾ï¼š<img src="http://www.iocoder.cn/images/RocketMQ/2019-11-05/01.jpg" alt="RocketMQ Console"></p>
<h1 id="5-ç®€å•ç¤ºä¾‹"><a href="#5-ç®€å•ç¤ºä¾‹" class="headerlink" title="5. ç®€å•ç¤ºä¾‹"></a>5. ç®€å•ç¤ºä¾‹</h1><p>æœ¬å°èŠ‚ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ç”Ÿäº§è€… Producer å‘é€æ¶ˆæ¯ï¼Œå’Œæ¶ˆè´¹è€… Consumer æ¶ˆè´¹æ¶ˆæ¯ã€‚</p>
<p>åœ¨ <a target="_blank" rel="noopener" href="https://github.com/apache/rocketmq">Rocketmq</a> ä»“åº“çš„ <a target="_blank" rel="noopener" href="https://github.com/apache/rocketmq/tree/master/example">example</a> ç›®å½•ä¸‹ï¼Œæä¾›äº† RocketMQ ç¤ºä¾‹ã€‚æœ¬å°èŠ‚ï¼Œæˆ‘ä»¬ä¸»è¦æ¥çœ‹çœ‹ <a target="_blank" rel="noopener" href="https://github.com/apache/rocketmq/tree/master/example/src/main/java/org/apache/rocketmq/example/quickstart">qucikstart</a> è¿™ä¸ªæœ€ç®€ç¤ºä¾‹ã€‚</p>
<h2 id="5-1-Producer"><a href="#5-1-Producer" class="headerlink" title="5.1 Producer"></a>5.1 Producer</h2><p><a target="_blank" rel="noopener" href="https://github.com/apache/rocketmq/blob/master/example/src/main/java/org/apache/rocketmq/example/quickstart/Producer.java">Producer</a> ç±»ï¼Œæä¾›ç”Ÿäº§è€… Producer å‘é€æ¶ˆæ¯çš„æœ€ç®€ç¤ºä¾‹ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Producer.javapublic class Producer &#123;    public static void main(String[] args) throws MQClientException, InterruptedException &#123;        /*         * Instantiate with a producer group name.         */        // &lt;1.1&gt; åˆ›å»º DefaultMQProducer å¯¹è±¡        DefaultMQProducer producer = new DefaultMQProducer(&quot;please_rename_unique_group_name&quot;);        // &lt;1.2&gt; è®¾ç½® RocketMQ Namesrv åœ°å€        producer.setNamesrvAddr(&quot;127.0.0.1:9876&quot;);        // &lt;1.3&gt; å¯åŠ¨ producer ç”Ÿäº§è€…        producer.start();        for (int i = 0; i &lt; 1000; i++) &#123;            try &#123;                // &lt;2.1&gt; åˆ›å»º Message æ¶ˆæ¯                Message msg = new Message(&quot;TopicTest&quot; /* Topic */,                    &quot;TagA&quot; /* Tag */,                    (&quot;Hello RocketMQ &quot; + i).getBytes(RemotingHelper.DEFAULT_CHARSET) /* Message body */                );                // &lt;2.2&gt; åŒæ­¥å‘é€æ¶ˆæ¯                SendResult sendResult = producer.send(msg);                // &lt;2.3&gt; æ‰“å°å‘é€ç»“æœ                System.out.printf(&quot;%s%n&quot;, sendResult);            &#125; catch (Exception e) &#123;                e.printStackTrace();                Thread.sleep(1000);            &#125;        &#125;        // &lt;3&gt; å…³é—­ producer ç”Ÿäº§è€…        producer.shutdown();    &#125;&#125;</span></span><br></pre></td></tr></table></figure>


<ul>
<li><p><code>&lt;1&gt;</code> å¤„ï¼Œåˆå§‹åŒ–ä¸€ä¸ª Producer ç”Ÿäº§è€…ã€‚</p>
<ul>
<li><code>&lt;1.1&gt;</code> å¤„ï¼Œåˆ›å»º DefaultMQProducer å¯¹è±¡ï¼Œè¿™é‡Œè®¾ç½®çš„ç”Ÿäº§è€…åˆ†ç»„æ˜¯ <code>&quot;please_rename_unique_group_name&quot;</code> ã€‚</li>
<li><code>&lt;1.2&gt;</code> å¤„ï¼Œè®¾ç½® è®¾ç½® <code>producer</code> çš„ RocketMQ Namesrv åœ°å€ã€‚è¿™é‡Œï¼Œæ˜¯è‰¿è‰¿é¢å¤–æ·»åŠ çš„ä»£ç ã€‚</li>
<li><code>&lt;1.3&gt;</code> å¤„ï¼Œå¯åŠ¨ <code>producer</code> ç”Ÿäº§è€…ã€‚</li>
</ul>
</li>
<li><p><code>&lt;2&gt;</code> å¤„ï¼Œä½¿ç”¨ Producer å‘é€ 1000 æ¡æ¶ˆæ¯ã€‚</p>
<ul>
<li><code>&lt;2.1&gt;</code> å¤„ï¼Œåˆ›å»º Message æ¶ˆæ¯ã€‚è¿™é‡Œè®¾ç½®äº†å…¶ Topic ä¸º <code>&quot;TopicTest&quot;</code>ï¼ŒTag ä¸º <code>TagA</code>ã€æ¶ˆæ¯ä½“ Body ä¸º <code>&quot;Hello RocketMQ&quot;</code> çš„äºŒè¿›åˆ¶æ•°ç»„ã€‚</li>
<li><code>&lt;2.2&gt;</code> å¤„ï¼Œè°ƒç”¨ç”Ÿäº§è€…çš„ <code>#send(Message msg)</code> æ–¹æ³•ï¼Œ<strong>åŒæ­¥</strong>å‘é€æ¶ˆæ¯ï¼Œç­‰å¾…å‘é€ç»“æœã€‚RocketMQ Producer ä¸€å…±æœ‰ä¸‰ç§å‘é€æ¶ˆæ¯çš„æ–¹å¼ï¼Œé™¤äº†æˆ‘ä»¬è¿™é‡Œçœ‹åˆ°çš„åŒæ­¥å‘é€æ¶ˆæ¯ä¹‹å¤–ï¼Œè¿˜æœ‰<strong>å¼‚æ­¥</strong>å‘é€æ¶ˆæ¯(å¯è§ <a target="_blank" rel="noopener" href="https://github.com/apache/rocketmq/blob/master/example/src/main/java/org/apache/rocketmq/example/simple/AsyncProducer.java">AsyncProducer</a> ç¤ºä¾‹)ï¼Œå’Œ <strong>Oneway</strong> å‘é€æ¶ˆæ¯ã€‚</li>
<li><code>&lt;2.3&gt;</code> å¤„ï¼Œæ‰“å°å‘é€ç»“æœã€‚</li>
</ul>
</li>
<li><p><code>&lt;3&gt;</code> å¤„ï¼Œå…³é—­ <code>producer</code> ç”Ÿäº§è€…ã€‚</p>
</li>
</ul>
<p>æ‰§è¡Œ <code>#main(args)</code> æ–¹æ³•ï¼Œå¼€å§‹å‘é€æ¶ˆæ¯ã€‚åœ¨æ§åˆ¶å°ä¸Šï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># å‘é€æ—¥å¿—ï¼Œçœç•¥å¦å¤– 999 æ¡æ—¥å¿—SendResult [sendStatus&#x3D;SEND_OK, msgId&#x3D;240E00E0F0931BB3FCEC071C1CDE61A8000018B4AAC20E79E06A03E7, offsetMsgId&#x3D;C0A82BF000002A9F000000000008EE72, messageQueue&#x3D;MessageQueue [topic&#x3D;TopicTest, brokerName&#x3D;broker-a, queueId&#x3D;0], queueOffset&#x3D;645]# å…³é—­ Producer æ—¥å¿—19:27:48.339 [NettyClientSelector_1] INFO  RocketmqRemoting - closeChannel: close the connection to remote address[127.0.0.1:9876] result: true19:27:48.340 [NettyClientSelector_1] INFO  RocketmqRemoting - closeChannel: close the connection to remote address[192.168.43.240:10911] result: true</span><br></pre></td></tr></table></figure>


<h2 id="5-2-Consumer"><a href="#5-2-Consumer" class="headerlink" title="5.2 Consumer"></a>5.2 Consumer</h2><p><a target="_blank" rel="noopener" href="https://github.com/apache/rocketmq/blob/master/example/src/main/java/org/apache/rocketmq/example/quickstart/Consumer.java">Consumer</a> ç±»ï¼Œæä¾›æ¶ˆè´¹è€… Consumer æ¶ˆè´¹æ¶ˆæ¯çš„æœ€ç®€ç¤ºä¾‹ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Consumer.javapublic class Consumer &#123;    public static void main(String[] args) throws InterruptedException, MQClientException &#123;        /*         * Instantiate with specified consumer group name.         */        // &lt;1&gt; åˆ›å»º DefaultMQPushConsumer å¯¹è±¡        DefaultMQPushConsumer consumer = new DefaultMQPushConsumer(&quot;please_rename_unique_group_name_4&quot;);        // &lt;2&gt; è®¾ç½® RocketMQ Namesrv åœ°å€        consumer.setNamesrvAddr(&quot;127.0.0.1:9876&quot;);        /*         * Specify name server addresses.         * &lt;p/&gt;         *         * Alternatively, you may specify name server addresses via exporting environmental variable: NAMESRV_ADDR         * &lt;pre&gt;         * &#123;@code         * consumer.setNamesrvAddr(&quot;name-server1-ip:9876;name-server2-ip:9876&quot;);         * &#125;         * &lt;/pre&gt;         */        /*         * Specify where to start in case the specified consumer group is a brand new one.         */        // &lt;3&gt; è®¾ç½®æ¶ˆè´¹è¿›åº¦ï¼Œä» Topic æœ€åˆä½ç½®å¼€å§‹        consumer.setConsumeFromWhere(ConsumeFromWhere.CONSUME_FROM_FIRST_OFFSET);        /*         * Subscribe one more more topics to consume.         */        // &lt;4&gt; è®¢é˜… TopicTest ä¸»é¢˜        consumer.subscribe(&quot;TopicTest&quot;, &quot;*&quot;);        /*         *  Register callback to execute on arrival of messages fetched from brokers.         */        // &lt;5&gt; æ·»åŠ æ¶ˆæ¯ç›‘å¬å™¨        consumer.registerMessageListener(new MessageListenerConcurrently() &#123;            @Override            public ConsumeConcurrentlyStatus consumeMessage(List&lt;MessageExt&gt; msgs,                ConsumeConcurrentlyContext context) &#123;                System.out.printf(&quot;%s Receive New Messages: %s %n&quot;, Thread.currentThread().getName(), msgs);                // è¿”å›æˆåŠŸ                return ConsumeConcurrentlyStatus.CONSUME_SUCCESS;            &#125;        &#125;);        /*         *  Launch the consumer instance.         */        // &lt;6&gt; å¯åŠ¨ producer æ¶ˆè´¹è€…        consumer.start();        // æ‰“å° Consumer å¯åŠ¨å®Œæˆ        System.out.printf(&quot;Consumer Started.%n&quot;);    &#125;&#125;</span></span><br></pre></td></tr></table></figure>


<ul>
<li><p><code>&lt;1&gt;</code> å¤„ï¼Œåˆ›å»º DefaultMQPushConsumer å¯¹è±¡ï¼Œè¿™é‡Œè®¾ç½®çš„æ¶ˆè´¹è€…åˆ†ç»„æ˜¯ <code>&quot;please_rename_unique_group_name&quot;</code> ã€‚æ³¨æ„ï¼Œæ¶ˆè´¹è€…åˆ†ç»„çš„æ¦‚å¿µï¼š</p>
<blockquote>
<p>FROM <a target="_blank" rel="noopener" href="https://github.com/apache/rocketmq/blob/master/docs/cn/concept.md">æ¦‚å¿µ(Concept)</a></p>
<p>åŒä¸€ç±» Consumer çš„é›†åˆï¼Œè¿™ç±» Consumer é€šå¸¸æ¶ˆè´¹åŒä¸€ç±»æ¶ˆæ¯ä¸”æ¶ˆè´¹é€»è¾‘ä¸€è‡´ã€‚æ¶ˆè´¹è€…ç»„ä½¿å¾—åœ¨æ¶ˆæ¯æ¶ˆè´¹æ–¹é¢ï¼Œå®ç°è´Ÿè½½å‡è¡¡å’Œå®¹é”™çš„ç›®æ ‡å˜å¾—éå¸¸å®¹æ˜“ã€‚</p>
<p>è¦æ³¨æ„çš„æ˜¯ï¼Œæ¶ˆè´¹è€…ç»„çš„æ¶ˆè´¹è€…å®ä¾‹å¿…é¡»è®¢é˜…å®Œå…¨ç›¸åŒçš„ Topic ã€‚</p>
<p>RocketMQ æ”¯æŒä¸¤ç§æ¶ˆæ¯æ¨¡å¼ï¼šé›†ç¾¤æ¶ˆè´¹ï¼ˆClusteringï¼‰å’Œå¹¿æ’­æ¶ˆè´¹ï¼ˆBroadcastingï¼‰ã€‚ * åœ¨é›†ç¾¤æ¶ˆè´¹ä¸‹ï¼ŒåŒä¸€æ¡æ¶ˆæ¯<strong>åª</strong>ä¼šè¢«<strong>ç›¸åŒ</strong>æ¶ˆè´¹è€…åˆ†ç»„çš„<strong>ä¸€ä¸ª</strong>æ¶ˆè´¹è€…æ‰€æ¶ˆè´¹ã€‚ * åœ¨å¹¿æ’­æ¶ˆè´¹ä¸‹ï¼ŒåŒä¸€æ¡æ¶ˆæ¯ä¼šè¢«<strong>ç›¸åŒ</strong>æ¶ˆè´¹è€…åˆ†ç»„çš„<strong>æ‰€æœ‰</strong>æ¶ˆè´¹è€…æ‰€æ¶ˆè´¹ã€‚ * åœ¨å½“å‰ç¤ºä¾‹é‡Œï¼Œæˆ‘ä»¬é‡‡ç”¨çš„æ˜¯ DefaultMQPushConsumer çš„é»˜è®¤æ¶ˆè´¹æ–¹å¼ï¼Œé›†ç¾¤æ¶ˆè´¹ã€‚</p>
</blockquote>
</li>
<li><p><code>&lt;2&gt;</code> å¤„ï¼Œè®¾ç½® <code>consumer</code> çš„ RocketMQ Namesrv åœ°å€ã€‚</p>
</li>
<li><p><code>&lt;3&gt;</code> å¤„ï¼Œè®¾ç½®ä¸€ä¸ª<strong>æ–°çš„</strong>æ¶ˆè´¹é›†ç¾¤ï¼Œåˆå§‹çš„æ¶ˆè´¹è¿›åº¦ã€‚ç›®å‰æœ‰ä¸‰ä¸ªé€‰é¡¹ï¼š</p>
<ul>
<li><code>CONSUME_FROM_FIRST_OFFSET</code> ï¼šæ¯ä¸ª Topic é˜Ÿåˆ—çš„ç¬¬ä¸€æ¡æ¶ˆæ¯ã€‚</li>
<li><code>CONSUME_FROM_LAST_OFFSET</code> ï¼šæ¯ä¸ª Topic é˜Ÿåˆ—çš„æœ€åä¸€æ¡æ¶ˆæ¯ã€‚</li>
<li><code>CONSUME_FROM_TIMESTAMP</code> ï¼šæ¯ä¸ª Topic é˜Ÿåˆ—çš„æŒ‡å®šæ—¶é—´å¼€å§‹çš„æ¶ˆæ¯ã€‚</li>
<li>ğŸ˜ˆ æ³¨æ„ï¼Œåªé’ˆå¯¹<strong>æ–°çš„</strong>æ¶ˆè´¹é›†ç¾¤ã€‚å¦‚æœä¸€ä¸ªé›†ç¾¤æ¯ä¸ª Topic å·²ç»æœ‰æ¶ˆè´¹è¿›åº¦ï¼Œåˆ™ç»§ç»­ä½¿ç”¨è¯¥æ¶ˆè´¹è¿›åº¦ã€‚ä»”ç»†ç†è§£ä¸€ä¸‹å“ˆ~</li>
</ul>
</li>
<li><p><code>&lt;4&gt;</code> å¤„ï¼Œè®¾ç½®è®¢é˜… <code>&quot;TopicTest&quot;</code> ä¸»é¢˜çš„æ¶ˆæ¯ã€‚<strong>æ¶ˆè´¹è€…ç»„çš„æ¶ˆè´¹è€…å®ä¾‹å¿…é¡»è®¢é˜…å®Œå…¨ç›¸åŒçš„ Topic + Tag</strong> ã€‚</p>
</li>
<li><p><code>&lt;5&gt;</code> å¤„ï¼Œæ·»åŠ æ¶ˆæ¯ç›‘å¬å™¨ã€‚è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨çš„æ˜¯ <a target="_blank" rel="noopener" href="https://github.com/apache/rocketmq/blob/master/client/src/main/java/org/apache/rocketmq/client/consumer/listener/MessageListenerConcurrently.java">MessageListenerConcurrently</a> <strong>å¹¶å‘</strong>æ¶ˆè´¹æ¶ˆæ¯çš„ç›‘å¬å™¨ã€‚å¦‚æœå¤§å®¶éœ€è¦å®ç°<strong>é¡ºåº</strong>æ¶ˆè´¹æ¶ˆæ¯ï¼Œéœ€è¦ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://github.com/apache/rocketmq/blob/master/client/src/main/java/org/apache/rocketmq/client/consumer/listener/MessageListenerOrderly.java">MessageListenerOrderly</a> <strong>é¡ºåº</strong>æ¶ˆè´¹çš„ç›‘å¬å™¨ã€‚</p>
</li>
<li><p><code>&lt;6&gt;</code> å¤„ï¼Œå¯åŠ¨ <code>consumer</code> æ¶ˆè´¹è€…ã€‚æ­¤æ—¶ï¼ŒConsumer å°±å¼€å§‹æ­£å¼çš„æ¶ˆè´¹æ¶ˆæ¯å•¦ã€‚ã€‚</p>
</li>
</ul>
<p>æ‰§è¡Œ <code>#main(args)</code> æ–¹æ³•ï¼Œå¼€å§‹æ¶ˆè´¹æ¶ˆæ¯ã€‚åœ¨æ§åˆ¶å°ä¸Šï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># æ¶ˆè´¹è€…å¯åŠ¨æˆåŠŸConsumer Started.# æ¶ˆè´¹å†…å®¹ConsumeMessageThread_1 Receive New Messages: [MessageExt [queueId&#x3D;2, storeSize&#x3D;225, queueOffset&#x3D;645, sysFlag&#x3D;0, bornTimestamp&#x3D;1575373846053, bornHost&#x3D;&#x2F;192.168.43.240:52717, storeTimestamp&#x3D;1575373846058, storeHost&#x3D;&#x2F;192.168.43.240:10911, msgId&#x3D;C0A82BF000002A9F000000000008EF55, commitLogOffset&#x3D;585557, bodyCRC&#x3D;613185359, reconsumeTimes&#x3D;0, preparedTransactionOffset&#x3D;0, toString()&#x3D;Message&#123;topic&#x3D;&#39;TopicTest&#39;, flag&#x3D;0, properties&#x3D;&#123;MIN_OFFSET&#x3D;0, MAX_OFFSET&#x3D;646, CONSUME_START_TIME&#x3D;1575373846067, UNIQ_KEY&#x3D;240E00E0F0931BB3FCEC071C1CDE61A8000018B4AAC20E8EE6250000, CLUSTER&#x3D;DefaultCluster, WAIT&#x3D;true, TAGS&#x3D;TagA&#125;, body&#x3D;[72, 101, 108, 108, 111, 32, 82, 111, 99, 107, 101, 116, 77, 81, 32, 48], transactionId&#x3D;&#39;null&#39;&#125;]]ConsumeMessageThread_2 Receive New Messages: [MessageExt [queueId&#x3D;3, storeSize&#x3D;225, queueOffset&#x3D;645, sysFlag&#x3D;0, bornTimestamp&#x3D;1575373846060, bornHost&#x3D;&#x2F;192.168.43.240:52717, storeTimestamp&#x3D;1575373846061, storeHost&#x3D;&#x2F;192.168.43.240:10911, msgId&#x3D;C0A82BF000002A9F000000000008F036, commitLogOffset&#x3D;585782, bodyCRC&#x3D;1401636825, reconsumeTimes&#x3D;0, preparedTransactionOffset&#x3D;0, toString()&#x3D;Message&#123;topic&#x3D;&#39;TopicTest&#39;, flag&#x3D;0, properties&#x3D;&#123;MIN_OFFSET&#x3D;0, MAX_OFFSET&#x3D;646, CONSUME_START_TIME&#x3D;1575373846067, UNIQ_KEY&#x3D;240E00E0F0931BB3FCEC071C1CDE61A8000018B4AAC20E8EE62C0001, CLUSTER&#x3D;DefaultCluster, WAIT&#x3D;true, TAGS&#x3D;TagA&#125;, body&#x3D;[72, 101, 108, 108, 111, 32, 82, 111, 99, 107, 101, 116, 77, 81, 32, 49], transactionId&#x3D;&#39;null&#39;&#125;]]</span><br></pre></td></tr></table></figure>
<ul>
<li>é€šè¿‡ <code>ConsumeMessageThread_1</code> å’Œ <code>ConsumeMessageThread_2</code> çº¿ç¨‹åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œç›®å‰æ˜¯è¿›è¡Œå¹¶å‘æ¶ˆè´¹æ¶ˆæ¯ã€‚</li>
</ul>
<p>åŸæ–‡åœ°å€ï¼š<a target="_blank" rel="noopener" href="https://www.iocoder.cn/RocketMQ/install/">ç‚¹å‡»è¿›å…¥</a></p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/bigdata/" rel="tag"># bigdata</a>
              <a href="/tags/rocketmq/" rel="tag"># rocketmq</a>
              <a href="/tags/%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6/" rel="tag"># æ¶ˆæ¯ä¸­é—´ä»¶</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/05/23/Flink-On-K8s-%E5%90%AF%E5%8A%A8TaskManager%E6%97%B6%E8%AE%BE%E7%BD%AEcpu-limit/" rel="prev" title="Flink On K8s å¯åŠ¨TaskManageræ—¶è®¾ç½®cpu limit">
      <i class="fa fa-chevron-left"></i> Flink On K8s å¯åŠ¨TaskManageræ—¶è®¾ç½®cpu limit
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/05/31/RocketMQ%E6%BA%90%E7%A0%81-2-%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/" rel="next" title="RocketMQæºç :2.è°ƒè¯•ç¯å¢ƒå‡†å¤‡">
      RocketMQæºç :2.è°ƒè¯•ç¯å¢ƒå‡†å¤‡ <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-%E6%A6%82%E8%BF%B0"><span class="nav-number">1.</span> <span class="nav-text">1. æ¦‚è¿°</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="nav-number">1.1.</span> <span class="nav-text">1.1 åŸºæœ¬æ¦‚å¿µ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2-%E6%95%B4%E4%BD%93%E6%9E%B6%E6%9E%84"><span class="nav-number">1.2.</span> <span class="nav-text">1.2 æ•´ä½“æ¶æ„</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-3-%E6%95%B4%E4%BD%93%E6%B5%81%E7%A8%8B"><span class="nav-number">1.3.</span> <span class="nav-text">1.3 æ•´ä½“æµç¨‹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-4-%E6%9B%B4%E5%A4%9A%E6%96%87%E6%A1%A3"><span class="nav-number">1.4.</span> <span class="nav-text">1.4 æ›´å¤šæ–‡æ¡£</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-%E5%8D%95%E6%9C%BA%E9%83%A8%E7%BD%B2"><span class="nav-number">2.</span> <span class="nav-text">2. å•æœºéƒ¨ç½²</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-%E5%89%8D%E7%BD%AE%E6%9D%A1%E4%BB%B6"><span class="nav-number">2.1.</span> <span class="nav-text">2.1 å‰ç½®æ¡ä»¶</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-2-%E4%B8%8B%E8%BD%BD%E6%BA%90%E7%A0%81"><span class="nav-number">2.2.</span> <span class="nav-text">2.2 ä¸‹è½½æºç </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-2-%E7%BC%96%E8%AF%91%E6%BA%90%E7%A0%81"><span class="nav-number">2.3.</span> <span class="nav-text">2.2 ç¼–è¯‘æºç </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-3-%E5%90%AF%E5%8A%A8-Namesrv"><span class="nav-number">2.4.</span> <span class="nav-text">2.3 å¯åŠ¨ Namesrv</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-4-%E5%90%AF%E5%8A%A8-Broker"><span class="nav-number">2.5.</span> <span class="nav-text">2.4 å¯åŠ¨ Broker</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-5-%E6%B5%8B%E8%AF%95%E5%8F%91%E9%80%81%E6%B6%88%E6%81%AF"><span class="nav-number">2.6.</span> <span class="nav-text">2.5 æµ‹è¯•å‘é€æ¶ˆæ¯</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-6-%E6%B5%8B%E8%AF%95%E6%B6%88%E8%B4%B9%E6%B6%88%E6%81%AF"><span class="nav-number">2.7.</span> <span class="nav-text">2.6 æµ‹è¯•æ¶ˆè´¹æ¶ˆæ¯</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2"><span class="nav-number">3.</span> <span class="nav-text">3. é›†ç¾¤éƒ¨ç½²</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-Web-Console-%E6%8E%A7%E5%88%B6%E5%8F%B0"><span class="nav-number">4.</span> <span class="nav-text">4. Web Console æ§åˆ¶å°</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-1-%E5%85%8B%E9%9A%86%E4%BB%A3%E7%A0%81"><span class="nav-number">4.1.</span> <span class="nav-text">4.1 å…‹éš†ä»£ç </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-2-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">4.2.</span> <span class="nav-text">4.2 é…ç½®æ–‡ä»¶</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-3-%E7%BC%96%E8%AF%91%E6%BA%90%E7%A0%81"><span class="nav-number">4.3.</span> <span class="nav-text">4.3 ç¼–è¯‘æºç </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-4-%E5%90%AF%E5%8A%A8%E6%8E%A7%E5%88%B6%E5%8F%B0"><span class="nav-number">4.4.</span> <span class="nav-text">4.4 å¯åŠ¨æ§åˆ¶å°</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-5-%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8"><span class="nav-number">4.5.</span> <span class="nav-text">4.5 ç®€å•ä½¿ç”¨</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-%E7%AE%80%E5%8D%95%E7%A4%BA%E4%BE%8B"><span class="nav-number">5.</span> <span class="nav-text">5. ç®€å•ç¤ºä¾‹</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#5-1-Producer"><span class="nav-number">5.1.</span> <span class="nav-text">5.1 Producer</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-2-Consumer"><span class="nav-number">5.2.</span> <span class="nav-text">5.2 Consumer</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">æå¿ å‹</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">28</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">æå¿ å‹</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> å¼ºåŠ›é©±åŠ¨
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
